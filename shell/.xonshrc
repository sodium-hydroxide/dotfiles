#!/usr/bin/env xonsh
import os
import subprocess
import tempfile

import matplotlib.pyplot as plt
import numpy as np


$XONSH_COLOR_STYLE = 'default'
$PROMPT = '{YELLOW}{env_name}{RESET}{GREEN}{user}@{hostname}{RED} {$PWD}{branch_color}{curr_branch: {}}{RESET} {RED}{last_return_code_if_nonzero:[{BOLD_INTENSE_RED}{}{RED}] }{RESET}{BLUE}\nâ€º{RESET} '
# Aliases

def lf_func(args, stdin=None, stdout=None, stderr=None):
    tmp = tempfile.mkstemp()[1]

    try:
        cmd = ["/opt/homebrew/bin/lf", f"-last-dir-path={tmp}"] + list(args)
        subprocess.call(cmd)

        if os.path.isfile(tmp):
            with open(tmp) as f:
                dir = f.read().strip()
            os.remove(tmp)

            if os.path.isdir(dir) and dir != str(__xonsh__.env['PWD']):
                os.chdir(dir)
    finally:
        if os.path.exists(tmp):
            os.remove(tmp)

aliases.update({
    "lg": "lazygit",
    "ls": "ls -CFl",
    "lsa": "ls -CFla",
    "vim": "vi",
    "cluster": "ssh njblair@129.82.20.78",
    "lf": lf_func
    #"dotedit": f"vi {$HOME}/dotfiles"
})
